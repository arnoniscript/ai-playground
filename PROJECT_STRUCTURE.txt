ai-marisa-playground/
â”‚
â”œâ”€â”€ ğŸ“‹ README.md                          # Overview do projeto
â”œâ”€â”€ ğŸ“‹ QUICKSTART.md                      # Guia de inÃ­cio rÃ¡pido (5 min)
â”œâ”€â”€ ğŸ“‹ IMPLEMENTATION_SUMMARY.md           # Este documento - resumo completo
â”œâ”€â”€ .gitignore
â”œâ”€â”€ setup.sh                              # Script de setup automÃ¡tico
â”‚
â”œâ”€â”€ ğŸ“ backend/                           # Node.js + Express (REST API)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.ts                       # Servidor Express - entry point
â”‚   â”‚   â”œâ”€â”€ config.ts                     # ConfiguraÃ§Ãµes (env vars)
â”‚   â”‚   â”œâ”€â”€ types.ts                      # Tipos TypeScript compartilhados
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ db/
â”‚   â”‚   â”‚   â””â”€â”€ client.ts                 # Cliente Supabase iniciado
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ middleware/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts                   # AutenticaÃ§Ã£o + RBAC
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ authMiddleware()      # Valida JWT
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ adminOnly()           # RestriÃ§Ã£o admin
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ testerOnly()          # RestriÃ§Ã£o tester
â”‚   â”‚   â”‚   â””â”€â”€ errorHandler.ts           # Tratamento de erros central
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ routes/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts                   # POST /auth/signup, /verify, /logout
â”‚   â”‚   â”‚   â”œâ”€â”€ admin.ts                  # GET/POST/PUT/DELETE /admin/playgrounds
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ /admin/playgrounds/:id/metrics
â”‚   â”‚   â”‚   â””â”€â”€ playgrounds.ts            # GET /playgrounds, POST evaluations
â”‚   â”‚   â”‚       â””â”€â”€ GET /playgrounds/:id/next-model
â”‚   â”‚   â”‚       â””â”€â”€ GET /playgrounds/:id/progress
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ schemas/
â”‚   â”‚   â”‚   â””â”€â”€ index.ts                  # ValidaÃ§Ãµes Zod para requests
â”‚   â”‚   â”‚       â”œâ”€â”€ SignupRequestSchema
â”‚   â”‚   â”‚       â”œâ”€â”€ VerifyOTPSchema
â”‚   â”‚   â”‚       â”œâ”€â”€ CreatePlaygroundSchema
â”‚   â”‚   â”‚       â””â”€â”€ SubmitEvaluationSchema
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ğŸ“ utils/
â”‚   â”‚       â””â”€â”€ auth.ts                   # Utilidades de autenticaÃ§Ã£o
â”‚   â”‚           â”œâ”€â”€ generateToken()
â”‚   â”‚           â”œâ”€â”€ verifyToken()
â”‚   â”‚           â”œâ”€â”€ validateEmailDomain()
â”‚   â”‚           â””â”€â”€ generateOTP()
â”‚   â”‚
â”‚   â”œâ”€â”€ package.json                      # DependÃªncias Node.js
â”‚   â”œâ”€â”€ tsconfig.json                     # ConfiguraÃ§Ã£o TypeScript
â”‚   â”œâ”€â”€ .env.example                      # Template de variÃ¡veis
â”‚   â”‚   â”œâ”€â”€ SUPABASE_URL
â”‚   â”‚   â”œâ”€â”€ SUPABASE_SERVICE_KEY
â”‚   â”‚   â”œâ”€â”€ JWT_SECRET
â”‚   â”‚   â”œâ”€â”€ ALLOWED_EMAIL_DOMAIN
â”‚   â”‚   â”œâ”€â”€ PORT
â”‚   â”‚   â”œâ”€â”€ NODE_ENV
â”‚   â”‚   â””â”€â”€ CORS_ORIGIN
â”‚   â”‚
â”‚   â””â”€â”€ dist/                             # Compilado (npm run build)
â”‚
â”œâ”€â”€ ğŸ“ frontend/                          # Next.js 14 + React 18
â”‚   â”œâ”€â”€ app/                              # PÃ¡ginas Next.js (App Router)
â”‚   â”‚   â”œâ”€â”€ page.tsx                      # / - Home page
â”‚   â”‚   â”œâ”€â”€ layout.tsx                    # Layout raiz
â”‚   â”‚   â”œâ”€â”€ globals.css                   # Estilos Tailwind
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ login/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx                  # /login - Login com OTP
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ dashboard/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx                  # /dashboard - Dashboard tester
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ğŸ“ admin/
â”‚   â”‚       â””â”€â”€ ğŸ“ dashboard/
â”‚   â”‚           â””â”€â”€ page.tsx              # /admin/dashboard - Admin
â”‚   â”‚
â”‚   â”œâ”€â”€ components/                       # Componentes reutilizÃ¡veis
â”‚   â”‚   â”œâ”€â”€ login-form.tsx                # FormulÃ¡rio OTP
â”‚   â”‚   â”œâ”€â”€ layout.tsx                    # Layout com navbar
â”‚   â”‚   â””â”€â”€ auth-guard.tsx                # ProteÃ§Ã£o de rotas (AuthGuard, AdminGuard)
â”‚   â”‚
â”‚   â”œâ”€â”€ lib/                              # LÃ³gica compartilhada
â”‚   â”‚   â”œâ”€â”€ api.ts                        # Cliente Axios com interceptors
â”‚   â”‚   â”œâ”€â”€ auth-store.ts                 # Store Zustand para auth
â”‚   â”‚   â”‚   â””â”€â”€ useAuthStore()
â”‚   â”‚   â”‚       â”œâ”€â”€ user
â”‚   â”‚   â”‚       â”œâ”€â”€ token
â”‚   â”‚   â”‚       â”œâ”€â”€ setAuth()
â”‚   â”‚   â”‚       â”œâ”€â”€ logout()
â”‚   â”‚   â”‚       â”œâ”€â”€ isAuthenticated()
â”‚   â”‚   â”‚       â””â”€â”€ isAdmin()
â”‚   â”‚   â””â”€â”€ types.ts                      # Tipos TypeScript
â”‚   â”‚       â”œâ”€â”€ User
â”‚   â”‚       â”œâ”€â”€ Playground
â”‚   â”‚       â”œâ”€â”€ Question
â”‚   â”‚       â””â”€â”€ Evaluation
â”‚   â”‚
â”‚   â”œâ”€â”€ package.json                      # DependÃªncias React/Next
â”‚   â”œâ”€â”€ tsconfig.json                     # ConfiguraÃ§Ã£o TypeScript
â”‚   â”œâ”€â”€ next.config.js                    # Config Next.js
â”‚   â”œâ”€â”€ tailwind.config.ts                # Config Tailwind CSS
â”‚   â”œâ”€â”€ postcss.config.js                 # Config PostCSS
â”‚   â”œâ”€â”€ .env.example                      # Template de variÃ¡veis
â”‚   â”‚   â”œâ”€â”€ NEXT_PUBLIC_API_URL
â”‚   â”‚   â”œâ”€â”€ NEXT_PUBLIC_SUPABASE_URL
â”‚   â”‚   â””â”€â”€ NEXT_PUBLIC_SUPABASE_ANON_KEY
â”‚   â”‚
â”‚   â””â”€â”€ .next/                            # Build output (npm run build)
â”‚
â”œâ”€â”€ ğŸ“ supabase/                          # ConfiguraÃ§Ã£o Supabase
â”‚   â””â”€â”€ ğŸ“ migrations/
â”‚       â””â”€â”€ 001_initial_schema.sql        # Schema PostgreSQL completo
â”‚           â”œâ”€â”€ CREATE TABLE users
â”‚           â”œâ”€â”€ CREATE TABLE playgrounds
â”‚           â”œâ”€â”€ CREATE TABLE model_configurations
â”‚           â”œâ”€â”€ CREATE TABLE evaluation_counters
â”‚           â”œâ”€â”€ CREATE TABLE questions
â”‚           â”œâ”€â”€ CREATE TABLE evaluations
â”‚           â”œâ”€â”€ CREATE TABLE audit_log
â”‚           â”œâ”€â”€ CREATE VIEW playground_metrics
â”‚           â”œâ”€â”€ CREATE VIEW question_metrics
â”‚           â”œâ”€â”€ CREATE VIEW open_responses
â”‚           â”œâ”€â”€ RLS Policies
â”‚           â””â”€â”€ Triggers (updated_at)
â”‚
â”œâ”€â”€ ğŸ“ docs/                              # DocumentaÃ§Ã£o completa
â”‚   â”œâ”€â”€ ğŸ“‹ database-schema.md             # Estrutura do banco (tabelas, views, Ã­ndices)
â”‚   â”œâ”€â”€ ğŸ“‹ api-endpoints.md               # Todos os endpoints com exemplos JSON
â”‚   â”œâ”€â”€ ğŸ“‹ auth-flow.md                   # Fluxo de autenticaÃ§Ã£o OTP
â”‚   â”œâ”€â”€ ğŸ“‹ setup-deployment.md            # Setup local e deploy produÃ§Ã£o
â”‚   â””â”€â”€ ğŸ“‹ TODO.md                        # Funcionalidades pendentes (priorizado)
â”‚
â””â”€â”€ .env files (nÃ£o versionados)
    â”œâ”€â”€ backend/.env.local
    â””â”€â”€ frontend/.env.local

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

RESUMO DE ARQUIVOS

Backend (Node.js):
  â”œâ”€â”€ 1 entry point (main.ts)
  â”œâ”€â”€ 3 rotas (auth, admin, playgrounds)
  â”œâ”€â”€ 3 middleware (auth, errorHandler)
  â”œâ”€â”€ 1 schemas (validaÃ§Ãµes Zod)
  â””â”€â”€ Total: ~1000 linhas de cÃ³digo TypeScript

Frontend (Next.js):
  â”œâ”€â”€ 5 pÃ¡ginas
  â”œâ”€â”€ 3 componentes
  â”œâ”€â”€ 3 libs/utilities
  â””â”€â”€ Total: ~800 linhas de cÃ³digo TypeScript/TSX

Database:
  â”œâ”€â”€ 7 tabelas
  â”œâ”€â”€ 3 views
  â”œâ”€â”€ 4 enums
  â”œâ”€â”€ Ãndices performance
  â”œâ”€â”€ RLS policies
  â””â”€â”€ Total: ~400 linhas SQL

DocumentaÃ§Ã£o:
  â”œâ”€â”€ 7 arquivos markdown
  â”œâ”€â”€ ~2000 linhas
  â””â”€â”€ Tudo documentado

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

FEATURES IMPLEMENTADAS

AutenticaÃ§Ã£o:
  âœ… Email + OTP (6 dÃ­gitos)
  âœ… ValidaÃ§Ã£o domÃ­nio @marisa.care
  âœ… JWT tokens (7 dias)
  âœ… Roles (admin, tester)
  âœ… RBAC (role-based access control)

Playgrounds:
  âœ… Tipo A/B Testing
  âœ… Tipo Tuning
  âœ… Perguntas customizadas (select, input_string)
  âœ… Limite de avaliaÃ§Ãµes por modelo
  âœ… RestriÃ§Ã£o por email (opcional)
  âœ… Suporte a HTML (support_text)

AvaliaÃ§Ãµes:
  âœ… Sorteio aleatÃ³rio A/B
  âœ… ValidaÃ§Ã£o de limites
  âœ… Session ID para agrupar respostas
  âœ… Contadores atÃ´micos

Banco de Dados:
  âœ… PostgreSQL (Supabase)
  âœ… 7 tabelas + 3 views
  âœ… Ãndices performance
  âœ… RLS policies (seguranÃ§a)
  âœ… Triggers (updated_at)

API:
  âœ… 10+ endpoints REST
  âœ… ValidaÃ§Ã£o Zod
  âœ… Tratamento erros centralizado
  âœ… CORS configurÃ¡vel

Frontend:
  âœ… TypeScript + React 18
  âœ… Tailwind CSS
  âœ… Zustand state management
  âœ… Auth guards
  âœ… API client com interceptors

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PRÃ“XIMOS PASSOS RECOMENDADOS (por prioridade)

1ï¸âƒ£  Componentes DinÃ¢micos (Semana 1)
   - FormulÃ¡rio de avaliaÃ§Ã£o (questÃµes dinÃ¢micas)
   - RenderizaÃ§Ã£o de modelo (Eleven Labs embed)
   - PÃ¡gina de avaliaÃ§Ã£o completa

2ï¸âƒ£  Dashboard Admin (Semana 2)
   - GrÃ¡ficos com Recharts
   - Tabela de respostas
   - ExportaÃ§Ã£o CSV

3ï¸âƒ£  Builder UI (Semana 3)
   - Criar playground (form)
   - Adicionar modelos
   - Editor de perguntas (drag-drop)

4ï¸âƒ£  ProduÃ§Ã£o (Semana 4)
   - Email real (SendGrid)
   - Rate limiting
   - Deploy Vercel
   - CI/CD GitHub Actions

Ver docs/TODO.md para todos os detalhes.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

COMO USAR AGORA

Local (Development):
  $ bash setup.sh
  $ cd backend && npm run dev    # Terminal 1, porta 3001
  $ cd frontend && npm run dev   # Terminal 2, porta 3000
  
  â†’ http://localhost:3000 (frontend)
  â†’ Login com teste@marisa.care
  â†’ OTP nos logs do backend

ProduÃ§Ã£o:
  â†’ Deploy backend para Vercel Functions
  â†’ Deploy frontend para Vercel
  â†’ Database Supabase (jÃ¡ em produÃ§Ã£o)
  â†’ Ver docs/setup-deployment.md

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

NOTAS IMPORTANTES

âœ… Pronto para:
  - Adicionar componentes (formulÃ¡rio, grÃ¡ficos)
  - Deploy em produÃ§Ã£o
  - ExpansÃ£o com novos recursos
  - Testes e melhorias

âš ï¸  Ainda NÃ£o Implementado:
  - UI dos formulÃ¡rios dinÃ¢micos
  - GrÃ¡ficos de mÃ©tricas
  - Email real para OTP
  - Rate limiting
  - Componentes avanÃ§ados

ğŸ” SeguranÃ§a:
  - RLS policies no banco
  - RBAC no backend
  - ValidaÃ§Ã£o em 2 camadas (Zod + DB)
  - JWT com expiraÃ§Ã£o

ğŸ“ˆ Escalabilidade:
  - OTP em memÃ³ria â†’ fÃ¡cil migrar para Redis
  - Pronto para horizontal scaling
  - Queries otimizadas com Ã­ndices

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STATUS: âœ… MVP COMPLETO

Toda a arquitetura base estÃ¡ implementada e pronta para:
  1. Componentes visuais (formulÃ¡rios, dashboards)
  2. Funcionalidades avanÃ§adas (email, analytics)
  3. Deployment em produÃ§Ã£o

